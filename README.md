# Feedback Collector Application

A multi-tier application for collecting and displaying user feedback, designed to run on OpenShift.

## Application Architecture

- **Frontend**: Nginx-based static web application
- **Backend**: Node.js Express API
- **Database**: MongoDB for persistent storage

## Prerequisites

- OpenShift CLI (oc)
- Git
- Access to an OpenShift cluster (Dev Sandbox or other)

## Deployment Steps

### 1. Clone the Repository

```bash
git clone https://github.com/yourusername/feedback-collector.git
cd feedback-collector
```

### 2. Login to OpenShift

```bash
oc login --token=<your-token> --server=<your-server>
```

### 3. Create a New Project

```bash
oc new-project feedback-collector
```

### 4. Import the Template

```bash
oc create -f openshift/feedback-app-template.yaml
```

### 5. Deploy the Application

```bash
oc new-app --template=feedback-app-template \
  --param=GITHUB_REPO=https://github.com/yourusername/feedback-collector.git \
  --param=GITHUB_BRANCH=main
```

### 6. Monitor the Deployment

```bash
oc get pods -w
```

### 7. Access the Application

Once the deployment is complete, get the route URL:

```bash
oc get route feedback-frontend
```

Open the URL in your browser to access the application.

## CI/CD Integration

The application is configured with the following CI/CD features:

1. **Source-to-Image (S2I)**: Builds the application from source code
2. **Build Triggers**: Automatically rebuilds when code changes
3. **GitHub Webhooks**: Triggers builds on code pushes

### Setting Up GitHub Webhooks

1. Get the webhook URL:

```bash
oc describe bc feedback-backend
```

2. Add the webhook to your GitHub repository:
   - Go to your repository settings
   - Navigate to Webhooks
   - Add a new webhook with the URL from step 1
   - Set the content type to `application/json`
   - Use the secret generated by the template

## Persistent Storage

The application uses persistent storage for MongoDB:

- **PVC**: `mongodb-pvc` with 1Gi storage
- **Access Mode**: ReadWriteOnce
- **Storage Class**: Default

## Customization

You can customize the deployment by modifying the parameters:

```bash
oc new-app --template=feedback-app-template \
  --param=MONGODB_PERSISTENT_VOLUME_SIZE=2Gi \
  --param=MONGODB_VERSION=4.4
```

## Troubleshooting

### Check Pod Logs

```bash
oc logs <pod-name>
```

### Check Build Logs

```bash
oc logs -f bc/feedback-backend
oc logs -f bc/feedback-frontend
```

### Check MongoDB Connection

```bash
oc rsh <mongodb-pod-name>
mongo -u $MONGODB_USER -p $MONGODB_PASSWORD $MONGODB_DATABASE
```

## Security Features

- Non-root container users
- Security context constraints
- TLS termination for routes
- Rate limiting
- Input validation
- XSS protection
